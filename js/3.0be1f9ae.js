(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[3],{"0565":function(e,t,i){"use strict";var n=i("16f0"),a=i.n(n);a.a},"16f0":function(e,t,i){},6082:function(e,t,i){"use strict";var n=i("9e1a"),a=i.n(n);a.a},"8b24":function(e,t,i){"use strict";i.r(t);var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("q-page",{staticClass:"q-pa-md flex column"},[n("div",{staticClass:"row q-mb-xs",staticStyle:{"align-items":"center"}},[n("div",{staticClass:"text-h5 text-weight-bold"},[e._v("CS 1301 Queue")]),n("q-space"),n("q-btn",{attrs:{flat:"",round:"",icon:"person"},on:{click:function(t){return e.$refs.identity.showModal()}}}),n("q-btn",{attrs:{flat:"",round:"",icon:"settings"},on:{click:function(t){return e.$refs.settings.showModal()}}})],1),e.isKiosk?n("div",{staticClass:"ultra col v1"},[n("div",{staticClass:"flex column col-grow col half left-half"},[n("draggable",{staticClass:"queue-scroll",attrs:{group:"person",disabled:!(e.isAdmin&&e.queue.length)},on:{start:function(t){e.drag=!0},end:function(t){e.drag=!0},update:e.updateQueue},model:{value:e.queue,callback:function(t){e.queue=t},expression:"queue"}},[e.queue.length?e._l(e.queue,(function(t,i){return n("div",{key:t.animal,staticClass:"queue-row",class:e.isAdmin?" cursor-pointer":""},[e.isAdmin&&!e.$q.screen.lt.sm?n("q-tooltip",{attrs:{anchor:"center right",self:"center right",offset:[-55,0],"content-style":"font-size: 12px; padding: 5px 10px","transition-show":"flip-right","transition-hide":"flip-left"}},[e._v("\n            "+e._s(t.name)+"\n          ")]):e._e(),n("div",{staticClass:"avatar flex flex-center tada",style:"background-color: "+e.getColor(t)+";"},[n("img",{attrs:{src:e.getIcon(t),alt:"Avatar"}})]),n("div",{staticClass:"name text-h6"},[e._v(e._s(i+1)+". "+e._s(t.animal))]),n("q-space"),e.isAdmin?n("q-btn",{directives:[{name:"ripple",rawName:"v-ripple",value:!1,expression:"false"}],attrs:{icon:"close",round:"",flat:""},on:{click:function(t){return t.stopPropagation(),e.dequeue(i)}}}):e._e()],1)})):n("div",{staticClass:"flex column flex-center col q-mt-lg empty-queue",staticStyle:{height:"90%",color:"#AAB2B8"}},[n("img",{staticStyle:{width:"200px"},attrs:{src:i("ea25"),alt:"Empty",draggable:"false"}}),n("div",{staticClass:"text-h5 text-weight-bold"},[e._v("Queue is empty!")])])],2),e.isKiosk?n("GTIDSearchBar",{ref:"gtidSearch",on:{enter:e.enqueue}}):e._e()],1),e.isKiosk?n("div",{staticClass:"flex col flex-center q-ml-md q-pa-sm half right-half"},[e.admins.length?n("div",[n("div",{staticClass:"text-h5 text-center text-weight-bold"},[e._v("TAs on Duty:")]),n("div",{staticClass:"admin-container"},e._l(e.admins,(function(t,i){return n("div",{key:t.name,staticClass:"admin q-ma-md",class:e.isAdmin?"removable cursor-pointer":"",on:{click:function(t){return t.stopPropagation(),e.removeAdmin(i)}}},[n("q-avatar",{attrs:{size:"170px"}},[n("img",{attrs:{src:"../statics/people/"+e.adminName(t).path+".png",alt:e.adminName(t).display}})]),n("div",{staticClass:"text-center text-weight-bold"},[e._v("\n              "+e._s(e.adminName(t).display)+"\n            ")])],1)})),0)]):n("div",[n("div",{staticClass:"text-h4 text-center text-weight-bold"},[e._v("No TAs on Duty")])])]):e._e()]):n("div",[e.queue.length?n("draggable",{attrs:{group:"person",disabled:!e.isAdmin},on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1},update:e.updateQueue},model:{value:e.queue,callback:function(t){e.queue=t},expression:"queue"}},e._l(e.queue,(function(t,i){return n("div",{key:t.animal,staticClass:"queue-row",class:e.isAdmin?" cursor-pointer":""},[e.isAdmin?n("q-tooltip",{attrs:{anchor:"center right",self:"center right",offset:[-55,0],"content-style":"font-size: 12px; padding: 5px 10px","transition-show":"flip-right","transition-hide":"flip-left"}},[e._v("\n          "+e._s(t.name)+"\n        ")]):e._e(),n("div",{staticClass:"avatar flex flex-center tada",style:"background-color: "+e.getColor(t)+";"},[n("img",{attrs:{src:e.getIcon(t),alt:"Avatar"}})]),n("div",{staticClass:"name text-h6"},[e._v(e._s(i+1)+". "+e._s(t.animal))]),n("q-space"),e.isAdmin?n("q-btn",{directives:[{name:"ripple",rawName:"v-ripple",value:!1,expression:"false"}],attrs:{icon:"close",round:"",flat:""},on:{click:function(t){return t.stopPropagation(),e.dequeue(i)}}}):e._e()],1)})),0):n("div",{staticClass:"flex column flex-center col q-mt-xl empty-queue",staticStyle:{height:"100%",color:"#AAB2B8"}},[n("img",{staticStyle:{width:"200px"},attrs:{src:i("ea25"),alt:"Empty",draggable:"false"}}),n("div",{staticClass:"text-h5 text-weight-bold"},[e._v("Queue is empty!")])])],1),n("SettingsModal",{ref:"settings",on:{"clear-queue":function(t){return e.clearQueue()},"clear-admins":function(t){return e.clearAdmins()},request:e.checkAdmin}}),n("IdentityModal",{ref:"identity",on:{request:e.checkIdentity}})],1)},a=[],s=(i("d25f"),i("7f7f"),i("b76a")),o=i.n(s),r=i("cc8f"),c=i("8aa5"),l=i.n(c),u=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-dialog",{on:{hide:e.closeModal},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("q-card",{staticClass:"modal-md"},[i("q-card-section",{staticClass:"row items-center q-pb-sm"},[i("div",{staticClass:"text-h6"},[e._v("Settings")]),i("q-space"),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),i("q-separator",{attrs:{inset:""}}),i("q-card-section",[i("div",{staticClass:"q-mb-sm text-weight-bold"},[e._v("Appearance:")]),i("q-toggle",{attrs:{value:e.$q.dark.isActive,icon:e.$q.dark.isActive?"brightness_2":"brightness_5",label:e.$q.dark.isActive?"Dark Mode":"Light Mode"},on:{input:e.toggleDarkMode}})],1),i("q-separator",{attrs:{inset:""}}),e.isAdmin?i("q-card-section",[i("div",{staticClass:"q-mb-sm text-weight-bold"},[e._v("Queue Control:")]),i("q-toggle",{attrs:{value:e.isKiosk,label:"Kiosk Mode",icon:e.isKiosk?"add_to_queue":"smartphone"},on:{input:e.toggleKiosk}}),i("br"),i("q-btn",{staticClass:"bg-primary text-white q-ma-sm",attrs:{icon:"delete",label:"Clear Queue"},on:{click:function(t){return t.stopPropagation(),e.clearQueue(t)}}}),i("q-btn",{staticClass:"bg-primary text-white q-ma-sm",attrs:{icon:"people",label:"Clear Admins"},on:{click:function(t){return t.stopPropagation(),e.clearAdmins(t)}}}),i("q-btn",{staticClass:"bg-primary text-white q-ma-sm",attrs:{icon:"lock",label:"Turn off Admin Mode"},on:{click:function(t){return t.stopPropagation(),e.setAdmin(!1)}}})],1):i("q-card-section",[e._v("\n      You must be a TA to access other queue settings. Please enter your GTID:\n      "),i("GTIDSearchBar",{ref:"gtidSearch",on:{enter:e.requestAuth}})],1)],1)],1)},d=[],h=(i("f751"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-form",{on:{submit:e.validateGtid}},[i("div",{staticClass:"row q-gutter-sm q-mt-md"},[i("q-input",{ref:"gtid",staticClass:"text-h6 col",attrs:{outlined:"",type:e.hideGtid?"password":"text",label:"9 Digit #GTID",autofocus:""},scopedSlots:e._u([{key:"append",fn:function(){return[i("q-icon",{staticClass:"cursor-pointer",attrs:{name:e.hideGtid?"visibility":"visibility_off"},on:{click:function(t){e.hideGtid=!e.hideGtid}}})]},proxy:!0}]),model:{value:e.gtid,callback:function(t){e.gtid=t},expression:"gtid"}}),i("q-btn",{staticClass:"bg-primary text-white",attrs:{loading:e.loading,disable:e.loading,icon:"arrow_forward",type:"submit"}})],1)])}),m=[],f=(i("386d"),{name:"GTIDSearchBar",mixins:[r["a"]],data:function(){return{gtid:"",hideGtid:!0}},methods:{validateGtid:function(){var e=this.filterGtid();e?(this.gtid=e,this.$emit("enter",e)):(this.notify("Please enter a valid GTID","red"),this.clearInput(),this.focusInput())},filterGtid:function(){var e=/90\d{7}/,t=9;if(this.gtid.length>=t){var i=this.gtid.search(e);if(-1!==i){var n=this.gtid.substring(i,i+t);if(n.length===t&&!isNaN(n))return n}}return""},focusInput:function(){this.$refs.gtid.focus()},clearInput:function(){this.gtid=""},resetInput:function(){this.hideGtid=!0,this.clearInput(),this.focusInput()}}}),p=f,g=i("2877"),v=i("0378"),q=i("27f9"),b=i("0016"),y=i("9c40"),x=i("eebe"),w=i.n(x),C=Object(g["a"])(p,h,m,!1,null,null,null),A=C.exports;w()(C,"components",{QForm:v["a"],QInput:q["a"],QIcon:b["a"],QBtn:y["a"]});var _={name:"SettingsModal",mixins:[r["a"]],components:{GTIDSearchBar:A},onIdle:function(){this.closeModal()},data:function(){return{show:!1,gtid:"",hideGtid:!0}},methods:{showModal:function(){this.show=!0},closeModal:function(){Object.assign(this.$data,this.$options.data())},toggleDarkMode:function(){this.$q.dark.toggle()},requestAuth:function(e){var t=this.hash(e);this.$emit("request",t)},clearQueue:function(){this.$emit("clear-queue")},clearAdmins:function(){this.$emit("clear-admins")}}},k=_,Q=i("24e8"),I=i("f09f"),S=i("a370"),$=i("2c91"),T=i("eb85"),D=i("9564"),G=i("7f67"),M=Object(g["a"])(k,u,d,!1,null,null,null),B=M.exports;w()(M,"components",{QDialog:Q["a"],QCard:I["a"],QCardSection:S["a"],QSpace:$["a"],QBtn:y["a"],QSeparator:T["a"],QToggle:D["a"]}),w()(M,"directives",{ClosePopup:G["a"]});var P=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("q-dialog",{on:{hide:e.closeModal},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[i("q-card",{staticClass:"modal-md"},[i("q-card-section",{staticClass:"row items-center q-pb-sm"},[i("div",{staticClass:"text-h6"},[e._v("Who Am I?")]),i("q-space"),i("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{icon:"close",flat:"",round:"",dense:""}})],1),i("q-separator",{attrs:{inset:""}}),i("q-card-section",[e._v("\n      To preserve your anonymity as a student, we replaced all student names\n      with colored animals. See your animal by entering your GTID below\n      (you'll also be able to see when you get to the top of queue!)\n      "),i("GTIDSearchBar",{ref:"gtidSearch",on:{enter:e.requestIdentity}}),e.person.name?i("div",[i("q-separator",{attrs:{inset:""}}),i("div",{staticClass:"text-center text-h6 q-my-sm"},[e._v("You are:")]),i("div",{staticClass:"queue-row"},[e.$q.screen.lt.sm?e._e():i("q-tooltip",{attrs:{anchor:"center right",self:"center right",offset:[-55,0],"content-style":"font-size: 12px; padding: 5px 10px","transition-show":"flip-right","transition-hide":"flip-left",value:!0,"no-parent-event":""}},[e._v("\n            "+e._s(e.person.name)+"\n          ")]),i("div",{staticClass:"avatar flex flex-center tada",style:"background-color: "+e.getColor(e.person)+";"},[i("img",{attrs:{src:e.getIcon(e.person),alt:"Avatar"}})]),i("div",{staticClass:"name text-h6"},[e._v(e._s(e.person.animal))])],1)],1):e._e()],1)],1)],1)},N=[],E={name:"IdentityModal",mixins:[r["a"]],components:{GTIDSearchBar:A},data:function(){return{show:!1,person:{name:"",animal:"",role:""}}},onIdle:function(){console.log("Idle behavior detected"),this.isKiosk&&(this.closeModal(),this.setCurrentUser(""))},methods:{showModal:function(){this.show=!0},closeModal:function(){Object.assign(this.$data,this.$options.data())},requestIdentity:function(e){var t=this.hash(e);this.$emit("request",t)},setPerson:function(e){this.person=e,this.setCurrentUser(e.animal)}}},K=E,z=(i("6082"),i("05c0")),U=Object(g["a"])(K,P,N,!1,null,"90acf0a0",null),j=U.exports;w()(U,"components",{QDialog:Q["a"],QCard:I["a"],QCardSection:S["a"],QSpace:$["a"],QBtn:y["a"],QSeparator:T["a"],QTooltip:z["a"]}),w()(U,"directives",{ClosePopup:G["a"]});var O={name:"Queue",mixins:[r["a"]],components:{draggable:o.a,SettingsModal:B,IdentityModal:j,GTIDSearchBar:A},onIdle:function(){console.log("Idle behavior detected"),this.isKiosk&&(this.$refs.gtidSearch.resetInput(),this.clearCurrentUser())},data:function(){return{queue:[],queueHeight:500,admins:[],db:null}},methods:{enqueue:function(e){if(this.isKiosk){var t=this,i=t.hash(e);t.loading=!0;var n=t.db.collection("users").doc(i);n.get().then((function(e){if(t.loading=!1,e.exists){var i=e.data(),n=i.role.toLowerCase();"ta"===n||"teacher"===n?t.addAdmin(i):t.addStudent(i)}else t.notify("Uh oh, looks like you're not in our roster!","red")})).catch((function(){t.loading=!1,t.notify("Uh oh, something went wrong!","red")})),this.$refs.gtidSearch.focusInput(),this.$refs.gtidSearch.clearInput()}else this.notify("Please visit the 1301 Helpdesk to add yourself to the queue","green")},addAdmin:function(e){var t=this,i=t.admins.filter((function(i){return t.isDuplicateEntry(i,e)}));i.length<=0&&(t.admins.push({animal:e.animal,name:e.name}),t.updateAdmins()),t.setAdmin(!0),t.notify("Welcome, ".concat(t.adminName(e).display,"!"),"green")},addStudent:function(e){var t=this,i=t.queue.filter((function(i){return t.isDuplicateEntry(i,e)}));i<=0?(t.queue.push({animal:e.animal,name:e.name}),t.updateQueue(),t.notify("Welcome, ".concat(t.adminName(e).display,"!"),"green")):t.notify("You're already on the queue!","green")},checkIdentity:function(e){var t=this;t.loading=!0;var i=t.db.collection("users").doc(e);i.get().then((function(e){t.loading=!1,e.exists?t.$refs.identity.setPerson(e.data()):t.notify("Uh oh, looks like you're not in our roster!","red")})).catch((function(){t.loading=!1,t.notify("Uh oh, something went wrong!","red")}))},checkAdmin:function(e){var t=this;t.loading=!0;var i=t.db.collection("users").doc(e);i.get().then((function(e){if(t.loading=!1,e.exists){var i=e.data().role.toLowerCase();"ta"===i||"teacher"===i?t.setAdmin(!0):t.notify("You are not authorized.","red")}else t.notify("You are not authorized.","red")})).catch((function(){t.loading=!1,t.notify("Uh oh, something went wrong!","red")}))},dequeue:function(e){this.isAdmin&&(this.queue.splice(e,1),this.updateQueue())},moveTo:function(e,t){var i=this.queue.splice(e,1)[0];this.queue.splice(t,0,i)},resizeHandler:function(e){this.queueHeight=e.height},removeAdmin:function(e){this.isAdmin&&(this.admins.splice(e,1),this.updateAdmins())},isDuplicateEntry:function(e,t){return e.name===t.name&&e.animal===t.animal},clearAdmins:function(){var e=this;this.isAdmin&&this.$q.dialog({title:"Clear TAs",parent:this,message:"Are you sure you want to remove all TAs? This cannot be undone.",cancel:!0}).onOk((function(){e.admins=[],e.updateAdmins()}))},clearQueue:function(){var e=this;this.isAdmin&&this.$q.dialog({title:"Clear Queue",parent:this,message:"Are you sure you want to clear the queue? This cannot be undone.",cancel:!0}).onOk((function(){e.queue=[],e.updateQueue()}))},updateQueue:function(){var e=this;console.log("Queue order has changed"),e.db.collection("students").doc("student-queue").set({queue:e.queue}).then((function(){console.log("Queue successfully written!")})).catch((function(e){console.error("Error writing queue: ",e)}))},updateAdmins:function(){var e=this;e.db.collection("tas").doc("ta-queue").set({queue:e.admins}).then((function(){console.log("Admins successfully written!")})).catch((function(e){console.error("Error writing admins: ",e)}))}},created:function(){var e=this,t=["Qpa7U","yA_fay2V","kyCe8mP","esz-4NyQ","AIzaS","rNR1Vj"];l.a.initializeApp({apiKey:t[4]+t[1]+t[3]+t[2]+t[5]+t[0],authDomain:"cs1301-queue.firebaseapp.com",databaseURL:"https://cs1301-queue.firebaseio.com",projectId:"cs1301-queue"}),e.db=l.a.firestore(),e.db.collection("students").doc("student-queue").onSnapshot((function(t){e.queue=t.data().queue})),e.db.collection("tas").doc("ta-queue").onSnapshot((function(t){e.admins=t.data().queue}))}},Y=O,H=(i("0565"),i("9989")),L=i("cb32"),R=i("714f"),W=Object(g["a"])(Y,n,a,!1,null,null,null);t["default"]=W.exports;w()(W,"components",{QPage:H["a"],QSpace:$["a"],QBtn:y["a"],QTooltip:z["a"],QAvatar:L["a"]}),w()(W,"directives",{Ripple:R["a"]})},"9e1a":function(e,t,i){},ea25:function(e,t,i){e.exports=i.p+"img/empty.aca21bc3.png"}}]);